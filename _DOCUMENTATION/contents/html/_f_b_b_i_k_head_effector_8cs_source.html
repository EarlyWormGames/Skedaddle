<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Skedaddle: Assets/Plugins/RootMotion/FinalIK/IK Solvers/FBBIKHeadEffector.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="lorisicon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Skedaddle
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_f_b_b_i_k_head_effector_8cs_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">FBBIKHeadEffector.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_f_b_b_i_k_head_effector_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_unity_engine.html">UnityEngine</a>;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Collections;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_root_motion.html">RootMotion</a>.FinalIK {</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html">    9</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html">FBBIKHeadEffector</a> : MonoBehaviour {</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Reference to the FBBIK component.&quot;</span>)]</div><div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a85cbd546d1b7b9eaedc86a0d82e3f8ef">   12</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html">FullBodyBipedIK</a> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a85cbd546d1b7b9eaedc86a0d82e3f8ef">ik</a>;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        </div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        [<a class="code" href="class_root_motion_1_1_large_header.html">LargeHeader</a>(<span class="stringliteral">&quot;Position&quot;</span>)]</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Master weight for positioning the head.&quot;</span>)]</div><div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a68b93f5ee6cd358b08a3120fe3dde767">   16</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> positionWeight = 1f;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        [Tooltip(<span class="stringliteral">&quot;The weight of moving the body along with the head&quot;</span>)]</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a1657e586b7bad0454d5979f7c1eaa4e8">   19</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> bodyWeight = 0.8f;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        [Tooltip(<span class="stringliteral">&quot;The weight of moving the thighs along with the head&quot;</span>)]</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#abe631892a2fb5c20ac437afd5a5aa9da">   22</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> thighWeight = 0.8f;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        </div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        [<a class="code" href="class_root_motion_1_1_large_header.html">LargeHeader</a>(<span class="stringliteral">&quot;Rotation&quot;</span>)]</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        [Tooltip(<span class="stringliteral">&quot;The weight of rotating the head bone after solving&quot;</span>)]</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a8cdffd60f0f793a071ac7ee5c5433283">   26</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> rotationWeight = 0f;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Clamping the rotation of the body&quot;</span>)]</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#abb88f38dbada6db2fc17e6cffef46751">   29</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> bodyClampWeight = 0.5f;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Clamping the rotation of the head&quot;</span>)]</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a5f4a4b1282149bf948dd213e6366bb62">   32</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> headClampWeight = 0.5f;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        [Tooltip(<span class="stringliteral">&quot;The master weight of bending/twisting the spine to the rotation of the head effector. This is similar to CCD, but uses the rotation of the head effector not the position.&quot;</span>)]</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#adee120ac8ec6eb2983c3eb83175fa85a">   35</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> bendWeight = 1f;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        </div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        [Tooltip(<span class="stringliteral">&quot;The bones to use for bending.&quot;</span>)]</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#ae3d680491f318aaca66ea3f00ee28c8c">   38</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html">BendBone</a>[] bendBones = <span class="keyword">new</span> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html">BendBone</a>[0];</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        [<a class="code" href="namespace_system.html">System</a>.Serializable]</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html">   41</a></span>&#160;        <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html">BendBone</a> {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            [Tooltip(<span class="stringliteral">&quot;Assign spine and/or neck bones.&quot;</span>)]</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a38ba95a86cc87ed9d13d0ff7f033afbc">   44</a></span>&#160;            <span class="keyword">public</span> Transform <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a38ba95a86cc87ed9d13d0ff7f033afbc">transform</a>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            [Tooltip(<span class="stringliteral">&quot;The weight of rotating this bone.&quot;</span>)]</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a80d46af0c9098a0d892fe8c3ed6cf373">   47</a></span>&#160;            [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> weight = 0.5f;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            <span class="keyword">private</span> Quaternion defaultLocalRotation = Quaternion.identity;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#ab6b85b4cfb664af461af620f82c35efa">   51</a></span>&#160;            <span class="keyword">public</span> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#ab6b85b4cfb664af461af620f82c35efa">BendBone</a>() {}</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a43b0bee099c48a8303721f2daac8962f">   53</a></span>&#160;            <span class="keyword">public</span> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a43b0bee099c48a8303721f2daac8962f">BendBone</a>(Transform transform, <span class="keywordtype">float</span> weight) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                this.transform = transform;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                this.weight = weight;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a72bf87f5adc45607ddce1937dd9d9642">   58</a></span>&#160;            <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a72bf87f5adc45607ddce1937dd9d9642">StoreDefaultLocalState</a>() {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                defaultLocalRotation = transform.localRotation;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#ad36fe7fb4551cb96e04b456a5b174fb5">   62</a></span>&#160;            <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#ad36fe7fb4551cb96e04b456a5b174fb5">FixTransforms</a>() {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                transform.localRotation = defaultLocalRotation;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        [<a class="code" href="class_root_motion_1_1_large_header.html">LargeHeader</a>(<span class="stringliteral">&quot;CCD&quot;</span>)]</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Optional. The master weight of the CCD (Cyclic Coordinate Descent) IK effect that bends the spine towards the head effector before FBBIK solves.&quot;</span>)] </div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#ae7745563964e42f5329f1e19274e5a9e">   69</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> CCDWeight = 1f;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        [Tooltip(<span class="stringliteral">&quot;The weight of rolling the bones in towards the target&quot;</span>)]</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#aa4b978418e2642a671c5e4fb5db7d77a">   72</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> roll = 0f;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Smoothing the CCD effect.&quot;</span>)]</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a273f803012f4c54cf5a421fb8f304f7e">   75</a></span>&#160;        [Range(0f, 1000f)] <span class="keyword">public</span> <span class="keywordtype">float</span> damper = 500f;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Bones to use for the CCD pass. Assign spine and/or neck bones.&quot;</span>)]</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#aee33dac1727bb99933e2e3900353d0ba">   78</a></span>&#160;        <span class="keyword">public</span> Transform[] CCDBones = <span class="keyword">new</span> Transform[0];</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        [<a class="code" href="class_root_motion_1_1_large_header.html">LargeHeader</a>(<span class="stringliteral">&quot;Stretching&quot;</span>)]</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Stretching the spine/neck to help reach the target. This is useful for making sure the head stays locked relative to the VR headset. NB! Stretching is done after FBBIK has solved so if you have the hand effectors pinned and spine bones included in the &#39;Stretch Bones&#39;, the hands might become offset from their target positions.&quot;</span>)]</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#aaebc03dfe32ed3e813a7e0901ab70aff">   82</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> postStretchWeight = 1f;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Stretch magnitude limit.&quot;</span>)]</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a67f5c51ca3cf5b4e558a9322c11a7e33">   85</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">float</span> maxStretch = 0.1f;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        [Tooltip(<span class="stringliteral">&quot;If &gt; 0, dampers the stretching effect.&quot;</span>)]</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a048ab15b5256bef7979ed26173e4da99">   87</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">float</span> stretchDamper = 0f;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        [Tooltip(<span class="stringliteral">&quot;If true, will fix head position to this Transform no matter what. Good for making sure the head will not budge away from the VR headset&quot;</span>)]</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#ad21cafb3e8e65a151a684d140b15b3b3">   89</a></span>&#160;        <span class="keyword">public</span> <span class="keywordtype">bool</span> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#ad21cafb3e8e65a151a684d140b15b3b3">fixHead</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        [Tooltip(<span class="stringliteral">&quot;Bones to use for stretching. The more bones you add, the less noticable the effect.&quot;</span>)]</div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a39f1ee2b7071843e6158ae3a70dcd044">   91</a></span>&#160;        <span class="keyword">public</span> Transform[] stretchBones = <span class="keyword">new</span> Transform[0];</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        [<a class="code" href="class_root_motion_1_1_large_header.html">LargeHeader</a>(<span class="stringliteral">&quot;Chest Direction&quot;</span>)]</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a5354e354e5a5f9fb110671daa9d0b212">   94</a></span>&#160;        <span class="keyword">public</span> Vector3 chestDirection = Vector3.forward;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#ad65788fa72ebe641efa980ee6ae7706b">   95</a></span>&#160;        [Range(0f, 1f)] <span class="keyword">public</span> <span class="keywordtype">float</span> chestDirectionWeight = 1f;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a67950e36f9fe985c7c257147d57a737b">   96</a></span>&#160;        <span class="keyword">public</span> Transform[] <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a67950e36f9fe985c7c257147d57a737b">chestBones</a>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a00a130dbf0770dc8d520031559af59c7">   98</a></span>&#160;        <span class="keyword">public</span> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html">IKSolver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a237d83c7b9c6eace8a21aa5821f0a671">UpdateDelegate</a> <a class="code" href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a00a130dbf0770dc8d520031559af59c7">OnPostHeadEffectorFK</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keyword">private</span> Vector3 offset, headToBody, shoulderCenterToHead, headToLeftThigh, headToRightThigh, leftShoulderPos, rightShoulderPos;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">float</span> shoulderDist, leftShoulderDist, rightShoulderDist;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keyword">private</span> Quaternion chestRotation;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keyword">private</span> Quaternion headRotationRelativeToRoot;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keyword">private</span> Quaternion[] ccdDefaultLocalRotations = <span class="keyword">new</span> Quaternion[0];</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keyword">private</span> Vector3 headLocalPosition;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keyword">private</span> Quaternion headLocalRotation;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keyword">private</span> Vector3[] stretchLocalPositions = <span class="keyword">new</span> Vector3[0];</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keyword">private</span> Quaternion[] stretchLocalRotations = <span class="keyword">new</span> Quaternion[0];</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keyword">private</span> Vector3[] chestLocalPositions = <span class="keyword">new</span> Vector3[0];</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">private</span> Quaternion[] chestLocalRotations = <span class="keyword">new</span> Quaternion[0];</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">int</span> bendBonesCount;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">int</span> ccdBonesCount;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">int</span> stretchBonesCount;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">int</span> chestBonesCount;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">// Register to get messages from the FBBIK</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordtype">void</span> Awake() {</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#a118a3650cb8bef7d81fe8081085be0a0">OnPreRead</a> += OnPreRead;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#a644052615e27543f862039ef09a8d2a3">OnPreIteration</a> += Iterate;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a848d38a01f7498761a3f9964a66f0555">OnPostUpdate</a> += OnPostUpdate;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#ac8f915abe3bcc14230e556566904a04c">OnStoreDefaultLocalState</a> += OnStoreDefaultLocalState;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#aea393686f485cd8fed883cb6f757a1e7">OnFixTransforms</a> += OnFixTransforms;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            headRotationRelativeToRoot = Quaternion.Inverse(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a9881cc2a81314b442244e08c5b7d62fc">root</a>.rotation) * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.rotation;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">// Store the default local positions and rotations of the bones used by this head effector.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> OnStoreDefaultLocalState() {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">foreach</span> (BendBone bendBone <span class="keywordflow">in</span> bendBones) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                <span class="keywordflow">if</span> (bendBone != null) bendBone.StoreDefaultLocalState();</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            ccdDefaultLocalRotations = <span class="keyword">new</span> Quaternion[CCDBones.Length];</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; CCDBones.Length; i++) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keywordflow">if</span> (CCDBones[i] != null) ccdDefaultLocalRotations[i] = CCDBones[i].localRotation;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            headLocalPosition = ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.localPosition;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            headLocalRotation = ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.localRotation;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            stretchLocalPositions = <span class="keyword">new</span> Vector3[stretchBones.Length];</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            stretchLocalRotations = <span class="keyword">new</span> Quaternion[stretchBones.Length];</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; stretchBones.Length; i++) {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="keywordflow">if</span> (stretchBones[i] != null) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    stretchLocalPositions[i] = stretchBones[i].localPosition;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    stretchLocalRotations[i] = stretchBones[i].localRotation;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            chestLocalPositions = <span class="keyword">new</span> Vector3[chestBones.Length];</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            chestLocalRotations = <span class="keyword">new</span> Quaternion[chestBones.Length];</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; chestBones.Length; i++) {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="keywordflow">if</span> (chestBones[i] != null) {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    chestLocalPositions[i] = chestBones[i].localPosition;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    chestLocalRotations[i] = chestBones[i].localRotation;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            bendBonesCount = bendBones.Length;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            ccdBonesCount = CCDBones.Length;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            stretchBonesCount = stretchBones.Length;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            chestBonesCount = chestBones.Length;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">// Fix the bones used by this head effector to their default local state</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> OnFixTransforms() {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordflow">if</span> (!ik.enabled) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">foreach</span> (BendBone bendBone <span class="keywordflow">in</span> bendBones) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keywordflow">if</span> (bendBone != null) bendBone.FixTransforms();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; CCDBones.Length; i++) {</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="keywordflow">if</span> (CCDBones[i] != null) CCDBones[i].localRotation = ccdDefaultLocalRotations[i];</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.localPosition = headLocalPosition;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.localRotation = headLocalRotation;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; stretchBones.Length; i++) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                <span class="keywordflow">if</span> (stretchBones[i] != null) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    stretchBones[i].localPosition = stretchLocalPositions[i];</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                    stretchBones[i].localRotation = stretchLocalRotations[i];</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; chestBones.Length; i++) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="keywordflow">if</span> (chestBones[i] != null) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    chestBones[i].localPosition = chestLocalPositions[i];</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    chestBones[i].localRotation = chestLocalRotations[i];</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                }</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">// Called by the FBBIK each time before it reads the pose</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> OnPreRead() {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keywordflow">if</span> (!enabled) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="keywordflow">if</span> (!ik.enabled) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keywordflow">if</span> (!gameObject.activeInHierarchy) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">if</span> (ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#a1c5503fc656cad2bdb10bfc511760424">iterations</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">if</span> (bendBonesCount != bendBones.Length || ccdBonesCount != CCDBones.Length || stretchBonesCount != stretchBones.Length || chestBonesCount != chestBones.Length) OnStoreDefaultLocalState();</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="comment">// Chest direction</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            ChestDirection();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="comment">// Spine Bend</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            SpineBend ();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="comment">// CCD</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            CCDPass();</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">// Body</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            offset = transform.position - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            </div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            shoulderDist = Vector3.Distance(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#afb1b13f2e8f216e7c7217762aa225f6a">leftUpperArm</a>.position, ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a255db332585a13c4e6d08602a74fb4ac">rightUpperArm</a>.position);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            leftShoulderDist = Vector3.Distance(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position, ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#afb1b13f2e8f216e7c7217762aa225f6a">leftUpperArm</a>.position);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            rightShoulderDist = Vector3.Distance(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position, ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a255db332585a13c4e6d08602a74fb4ac">rightUpperArm</a>.position);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            </div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            headToBody = ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a9a18dc6b6c5d26df3e1ec2ab33b07239">rootNode</a>.position - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            headToLeftThigh = ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a88d891301bf912988dafb043b8619552">leftThigh</a>.position - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            headToRightThigh = ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a74381fef16ab26ef3a4278539db84bf5">rightThigh</a>.position - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            leftShoulderPos = ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#afb1b13f2e8f216e7c7217762aa225f6a">leftUpperArm</a>.position + offset * bodyWeight;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            rightShoulderPos = ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a255db332585a13c4e6d08602a74fb4ac">rightUpperArm</a>.position + offset * bodyWeight;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            chestRotation = Quaternion.LookRotation(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#afb1b13f2e8f216e7c7217762aa225f6a">leftUpperArm</a>.position, ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a255db332585a13c4e6d08602a74fb4ac">rightUpperArm</a>.position - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#afb1b13f2e8f216e7c7217762aa225f6a">leftUpperArm</a>.position);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">if</span> (OnPostHeadEffectorFK != null) OnPostHeadEffectorFK ();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">// Bending the spine to the head effector</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> SpineBend() {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordtype">float</span> w = bendWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">if</span> (w &lt;= 0f) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordflow">if</span> (bendBones.Length == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            Quaternion rotation = transform.rotation * Quaternion.Inverse(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a9881cc2a81314b442244e08c5b7d62fc">root</a>.rotation * headRotationRelativeToRoot);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            rotation = QuaTools.ClampRotation(rotation, bodyClampWeight, 2);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordtype">float</span> step = 1f / bendBones.Length;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; bendBones.Length; i++) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="keywordflow">if</span> (bendBones[i].transform != null) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    bendBones[i].transform.rotation = Quaternion.Lerp(Quaternion.identity, rotation, step * bendBones[i].weight * w) * bendBones[i].transform.rotation;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">// Single CCD pass to make the spine less stiff </span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> CCDPass() {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordtype">float</span> w = CCDWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">if</span> (w &lt;= 0f) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = CCDBones.Length - 1; i &gt; -1; i--) {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                Quaternion r = Quaternion.FromToRotation(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position - CCDBones[i].position, transform.position - CCDBones[i].position) * CCDBones[i].rotation;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <span class="keywordtype">float</span> d = Mathf.Lerp((CCDBones.Length - i) / CCDBones.Length, 1f, roll);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordtype">float</span> a = Quaternion.Angle(Quaternion.identity, r);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                </div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                a = Mathf.Lerp(0f, a, (damper - a) / damper);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                </div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                CCDBones[i].rotation = Quaternion.RotateTowards(CCDBones[i].rotation, r, a * w * d);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="comment">// Called by the FBBIK before each solver iteration</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> Iterate(<span class="keywordtype">int</span> iteration) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordflow">if</span> (!enabled) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">if</span> (!ik.enabled) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">if</span> (!gameObject.activeInHierarchy) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">if</span> (ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#a1c5503fc656cad2bdb10bfc511760424">iterations</a> == 0) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="comment">// Shoulders</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            leftShoulderPos = transform.position + (leftShoulderPos - transform.position).normalized * leftShoulderDist;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            rightShoulderPos = transform.position + (rightShoulderPos - transform.position).normalized * rightShoulderDist;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            Solve (ref leftShoulderPos, ref rightShoulderPos, shoulderDist);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            LerpSolverPosition(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a52a063d6e54f2007426c39ea47b2cbf4">leftShoulderEffector</a>, leftShoulderPos, positionWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>, ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a52a063d6e54f2007426c39ea47b2cbf4">leftShoulderEffector</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a52f2871aaf5b38273bde9e1910b6626b">positionOffset</a>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            LerpSolverPosition(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#ad29051cd81fc4542d0e9517ee99a4c64">rightShoulderEffector</a>, rightShoulderPos, positionWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>, ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#ad29051cd81fc4542d0e9517ee99a4c64">rightShoulderEffector</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a52f2871aaf5b38273bde9e1910b6626b">positionOffset</a>);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">// Body</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            Quaternion chestRotationSolved = Quaternion.LookRotation(transform.position - leftShoulderPos, rightShoulderPos - leftShoulderPos);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            Quaternion rBody = QuaTools.FromToRotation(chestRotation, chestRotationSolved);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            Vector3 headToBodySolved = rBody * headToBody;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            LerpSolverPosition(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#af0f747553657a86a31e46d7a77286274">bodyEffector</a>, transform.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a3ed027b3d54e6afa83aa3f293e84f629">position</a> + headToBodySolved, positionWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>, ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#af0f747553657a86a31e46d7a77286274">bodyEffector</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a52f2871aaf5b38273bde9e1910b6626b">positionOffset</a> - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a8f89027d56337408f1de36867867f58e">pullBodyOffset</a>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="comment">// Thighs</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            Quaternion rThighs = Quaternion.Lerp(Quaternion.identity, rBody, thighWeight);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            </div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            Vector3 headToLeftThighSolved = rThighs * headToLeftThigh;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            Vector3 headToRightThighSolved = rThighs * headToRightThigh;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            LerpSolverPosition(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#ae122df730de97aa4bcd06ef6bd9f9ffc">leftThighEffector</a>, transform.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a3ed027b3d54e6afa83aa3f293e84f629">position</a> + headToLeftThighSolved, positionWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>, (ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#af0f747553657a86a31e46d7a77286274">bodyEffector</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a52f2871aaf5b38273bde9e1910b6626b">positionOffset</a> - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a8f89027d56337408f1de36867867f58e">pullBodyOffset</a>) + ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#ae122df730de97aa4bcd06ef6bd9f9ffc">leftThighEffector</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a52f2871aaf5b38273bde9e1910b6626b">positionOffset</a>);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            LerpSolverPosition(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a11b63ebb06b59132ee2988963de88088">rightThighEffector</a>, transform.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a3ed027b3d54e6afa83aa3f293e84f629">position</a> + headToRightThighSolved, positionWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>, (ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#af0f747553657a86a31e46d7a77286274">bodyEffector</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a52f2871aaf5b38273bde9e1910b6626b">positionOffset</a> - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a8f89027d56337408f1de36867867f58e">pullBodyOffset</a>) + ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a11b63ebb06b59132ee2988963de88088">rightThighEffector</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a52f2871aaf5b38273bde9e1910b6626b">positionOffset</a>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="comment">// Called by the FBBIK each time it is finished updating</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> OnPostUpdate() {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="keywordflow">if</span> (!enabled) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">if</span> (!ik.enabled) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">if</span> (!gameObject.activeInHierarchy) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="comment">// Stretching the spine and neck</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            PostStretching ();</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="comment">// Rotate the head bone</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            Quaternion headRotation = QuaTools.FromToRotation(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.rotation, transform.rotation);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            headRotation = QuaTools.ClampRotation(headRotation, headClampWeight, 2);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.rotation = Quaternion.Lerp(Quaternion.identity, headRotation, rotationWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>) * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.rotation;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        }</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> ChestDirection() {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordtype">float</span> w = chestDirectionWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="keywordflow">if</span> (w &lt;= 0f) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordtype">bool</span> changed = <span class="keyword">false</span>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            chestDirection = <a class="code" href="namespace_root_motion.html">RootMotion</a>.<a class="code" href="class_root_motion_1_1_v3_tools.html">V3Tools</a>.ClampDirection(chestDirection, ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a9881cc2a81314b442244e08c5b7d62fc">root</a>.forward, 0.45f, 2, out changed);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">if</span> (chestDirection == Vector3.zero) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            Quaternion q = Quaternion.FromToRotation (ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a9881cc2a81314b442244e08c5b7d62fc">root</a>.forward, chestDirection);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            q = Quaternion.Lerp (Quaternion.identity, q, w * (1f / chestBones.Length));</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="keywordflow">foreach</span> (Transform bone <span class="keywordflow">in</span> chestBones) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                bone.rotation = q * bone.rotation;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">// Stretching the spine/neck to help reach the target. This is most useful for making sure the head stays locked relative to the VR controller</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> PostStretching() {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keywordtype">float</span> w = postStretchWeight * ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">if</span> (w &gt; 0f) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                Vector3 stretch = Vector3.ClampMagnitude(transform.position - ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position, maxStretch);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                stretch *= w;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                stretchDamper = Mathf.Max (stretchDamper, 0f);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="keywordflow">if</span> (stretchDamper &gt; 0f) stretch /= (1f + stretch.magnitude) * (1f + stretchDamper);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                </div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; stretchBones.Length; i++) {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    <span class="keywordflow">if</span> (stretchBones[i] != null) stretchBones[i].position += stretch / stretchBones.Length;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">if</span> (fixHead &amp;&amp; ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">IKPositionWeight</a> &gt; 0f) ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">references</a>.<a class="code" href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">head</a>.position = transform.position;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">// Interpolate the solver position of the effector</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> LerpSolverPosition(IKEffector effector, Vector3 position, <span class="keywordtype">float</span> weight, Vector3 offset) {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            effector.GetNode(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>).solverPosition = Vector3.Lerp(effector.GetNode(ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>).solverPosition, position + offset, weight);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">// Solve a simple linear constraint</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">private</span> <span class="keywordtype">void</span> Solve(ref Vector3 pos1, ref Vector3 pos2, <span class="keywordtype">float</span> nominalDistance) {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            Vector3 direction = pos2 - pos1;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordtype">float</span> distance = direction.magnitude;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordflow">if</span> (distance == nominalDistance) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">if</span> (distance == 0f) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordtype">float</span> force = 1f;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            </div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            force *= 1f - nominalDistance / distance;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            Vector3 offset = direction * force * 0.5f;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            </div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            pos1 += offset;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            pos2 -= offset;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// Clean up the delegates</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordtype">void</span> OnDestroy() {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            <span class="keywordflow">if</span> (ik != null) {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#a118a3650cb8bef7d81fe8081085be0a0">OnPreRead</a> -= OnPreRead;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#a644052615e27543f862039ef09a8d2a3">OnPreIteration</a> -= Iterate;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a848d38a01f7498761a3f9964a66f0555">OnPostUpdate</a> -= OnPostUpdate;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#ac8f915abe3bcc14230e556566904a04c">OnStoreDefaultLocalState</a> -= OnStoreDefaultLocalState;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                ik.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">solver</a>.<a class="code" href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#aea393686f485cd8fed883cb6f757a1e7">OnFixTransforms</a> -= OnFixTransforms;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div><div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_html_ac8f915abe3bcc14230e556566904a04c"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#ac8f915abe3bcc14230e556566904a04c">RootMotion.FinalIK.IKSolverFullBody.OnStoreDefaultLocalState</a></div><div class="ttdeci">UpdateDelegate OnStoreDefaultLocalState</div><div class="ttdoc">Called when storing default local state (the state that FixTransforms will reset the hierarchy to)...</div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_8cs_source.html#l00151">IKSolverFullBody.cs:151</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone_html_ab6b85b4cfb664af461af620f82c35efa"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#ab6b85b4cfb664af461af620f82c35efa">RootMotion.FinalIK.FBBIKHeadEffector.BendBone.BendBone</a></div><div class="ttdeci">BendBone()</div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00051">FBBIKHeadEffector.cs:51</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_html_a85cbd546d1b7b9eaedc86a0d82e3f8ef"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a85cbd546d1b7b9eaedc86a0d82e3f8ef">RootMotion.FinalIK.FBBIKHeadEffector.ik</a></div><div class="ttdeci">FullBodyBipedIK ik</div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00012">FBBIKHeadEffector.cs:12</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_html_a67950e36f9fe985c7c257147d57a737b"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a67950e36f9fe985c7c257147d57a737b">RootMotion.FinalIK.FBBIKHeadEffector.chestBones</a></div><div class="ttdeci">Transform [] chestBones</div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00096">FBBIKHeadEffector.cs:96</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_html_a8556d2cdc9eb04701ff0c2cf76cb0c88"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a8556d2cdc9eb04701ff0c2cf76cb0c88">RootMotion.FinalIK.IKSolver.IKPositionWeight</a></div><div class="ttdeci">float IKPositionWeight</div><div class="ttdoc">The IK position weight. </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_8cs_source.html#l00075">IKSolver.cs:75</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_html_a118a3650cb8bef7d81fe8081085be0a0"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#a118a3650cb8bef7d81fe8081085be0a0">RootMotion.FinalIK.IKSolverFullBody.OnPreRead</a></div><div class="ttdeci">UpdateDelegate OnPreRead</div><div class="ttdoc">Called before reading the pose </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_8cs_source.html#l00127">IKSolverFullBody.cs:127</a></div></div>
<div class="ttc" id="class_root_motion_1_1_biped_references_html_afb1b13f2e8f216e7c7217762aa225f6a"><div class="ttname"><a href="class_root_motion_1_1_biped_references.html#afb1b13f2e8f216e7c7217762aa225f6a">RootMotion.BipedReferences.leftUpperArm</a></div><div class="ttdeci">Transform leftUpperArm</div><div class="ttdoc">The first bone of the left arm. </div><div class="ttdef"><b>Definition:</b> <a href="_biped_references_8cs_source.html#l00050">BipedReferences.cs:50</a></div></div>
<div class="ttc" id="class_root_motion_1_1_biped_references_html_a88d891301bf912988dafb043b8619552"><div class="ttname"><a href="class_root_motion_1_1_biped_references.html#a88d891301bf912988dafb043b8619552">RootMotion.BipedReferences.leftThigh</a></div><div class="ttdeci">Transform leftThigh</div><div class="ttdoc">The first bone of the left leg. </div><div class="ttdef"><b>Definition:</b> <a href="_biped_references_8cs_source.html#l00026">BipedReferences.cs:26</a></div></div>
<div class="ttc" id="class_root_motion_1_1_biped_references_html_a74381fef16ab26ef3a4278539db84bf5"><div class="ttname"><a href="class_root_motion_1_1_biped_references.html#a74381fef16ab26ef3a4278539db84bf5">RootMotion.BipedReferences.rightThigh</a></div><div class="ttdeci">Transform rightThigh</div><div class="ttdoc">The first bone of the right leg. </div><div class="ttdef"><b>Definition:</b> <a href="_biped_references_8cs_source.html#l00038">BipedReferences.cs:38</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_html_a00a130dbf0770dc8d520031559af59c7"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#a00a130dbf0770dc8d520031559af59c7">RootMotion.FinalIK.FBBIKHeadEffector.OnPostHeadEffectorFK</a></div><div class="ttdeci">IKSolver.UpdateDelegate OnPostHeadEffectorFK</div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00098">FBBIKHeadEffector.cs:98</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped_html_a11b63ebb06b59132ee2988963de88088"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a11b63ebb06b59132ee2988963de88088">RootMotion.FinalIK.IKSolverFullBodyBiped.rightThighEffector</a></div><div class="ttdeci">IKEffector rightThighEffector</div><div class="ttdoc">Gets the right thigh effector. </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_biped_8cs_source.html#l00081">IKSolverFullBodyBiped.cs:81</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_effector_html_a3ed027b3d54e6afa83aa3f293e84f629"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a3ed027b3d54e6afa83aa3f293e84f629">RootMotion.FinalIK.IKEffector.position</a></div><div class="ttdeci">Vector3 position</div><div class="ttdoc">The effector position in world space. </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_effector_8cs_source.html#l00042">IKEffector.cs:42</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped_html_ae122df730de97aa4bcd06ef6bd9f9ffc"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#ae122df730de97aa4bcd06ef6bd9f9ffc">RootMotion.FinalIK.IKSolverFullBodyBiped.leftThighEffector</a></div><div class="ttdeci">IKEffector leftThighEffector</div><div class="ttdoc">Gets the left thigh effector. </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_biped_8cs_source.html#l00077">IKSolverFullBodyBiped.cs:77</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone_html"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html">RootMotion.FinalIK.FBBIKHeadEffector.BendBone</a></div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00041">FBBIKHeadEffector.cs:41</a></div></div>
<div class="ttc" id="class_root_motion_1_1_biped_references_html_a0934fcbdbdb9d80099bd014a134319e0"><div class="ttname"><a href="class_root_motion_1_1_biped_references.html#a0934fcbdbdb9d80099bd014a134319e0">RootMotion.BipedReferences.head</a></div><div class="ttdeci">Transform head</div><div class="ttdoc">The head. </div><div class="ttdef"><b>Definition:</b> <a href="_biped_references_8cs_source.html#l00074">BipedReferences.cs:74</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_html_ad21cafb3e8e65a151a684d140b15b3b3"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html#ad21cafb3e8e65a151a684d140b15b3b3">RootMotion.FinalIK.FBBIKHeadEffector.fixHead</a></div><div class="ttdeci">bool fixHead</div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00089">FBBIKHeadEffector.cs:89</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_html_a237d83c7b9c6eace8a21aa5821f0a671"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a237d83c7b9c6eace8a21aa5821f0a671">RootMotion.FinalIK.IKSolver.UpdateDelegate</a></div><div class="ttdeci">delegate void UpdateDelegate()</div><div class="ttdoc">Delegates solver update events. </div></div>
<div class="ttc" id="class_root_motion_1_1_biped_references_html_a9881cc2a81314b442244e08c5b7d62fc"><div class="ttname"><a href="class_root_motion_1_1_biped_references.html#a9881cc2a81314b442244e08c5b7d62fc">RootMotion.BipedReferences.root</a></div><div class="ttdeci">Transform root</div><div class="ttdoc">The root transform is the parent of all the biped&amp;#39;s bones and should be located at ground level...</div><div class="ttdef"><b>Definition:</b> <a href="_biped_references_8cs_source.html#l00018">BipedReferences.cs:18</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped_html_a52a063d6e54f2007426c39ea47b2cbf4"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a52a063d6e54f2007426c39ea47b2cbf4">RootMotion.FinalIK.IKSolverFullBodyBiped.leftShoulderEffector</a></div><div class="ttdeci">IKEffector leftShoulderEffector</div><div class="ttdoc">Gets the left shoulder effector. </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_biped_8cs_source.html#l00069">IKSolverFullBodyBiped.cs:69</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone_html_a72bf87f5adc45607ddce1937dd9d9642"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a72bf87f5adc45607ddce1937dd9d9642">RootMotion.FinalIK.FBBIKHeadEffector.BendBone.StoreDefaultLocalState</a></div><div class="ttdeci">void StoreDefaultLocalState()</div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00058">FBBIKHeadEffector.cs:58</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone_html_a43b0bee099c48a8303721f2daac8962f"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a43b0bee099c48a8303721f2daac8962f">RootMotion.FinalIK.FBBIKHeadEffector.BendBone.BendBone</a></div><div class="ttdeci">BendBone(Transform transform, float weight)</div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00053">FBBIKHeadEffector.cs:53</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k_html_ae1ba56ebef8d8312da5a610a90472823"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#ae1ba56ebef8d8312da5a610a90472823">RootMotion.FinalIK.FullBodyBipedIK.solver</a></div><div class="ttdeci">IKSolverFullBodyBiped solver</div><div class="ttdoc">The FullBodyBiped IK solver. </div><div class="ttdef"><b>Definition:</b> <a href="_full_body_biped_i_k_8cs_source.html#l00057">FullBodyBipedIK.cs:57</a></div></div>
<div class="ttc" id="namespace_root_motion_html"><div class="ttname"><a href="namespace_root_motion.html">RootMotion</a></div></div>
<div class="ttc" id="class_root_motion_1_1_large_header_html"><div class="ttname"><a href="class_root_motion_1_1_large_header.html">RootMotion.LargeHeader</a></div><div class="ttdoc">Large header attribute for Editor. </div><div class="ttdef"><b>Definition:</b> <a href="_large_header_8cs_source.html#l00009">LargeHeader.cs:9</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped_html_a9a18dc6b6c5d26df3e1ec2ab33b07239"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a9a18dc6b6c5d26df3e1ec2ab33b07239">RootMotion.FinalIK.IKSolverFullBodyBiped.rootNode</a></div><div class="ttdeci">Transform rootNode</div><div class="ttdoc">The central root node (body). </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_biped_8cs_source.html#l00045">IKSolverFullBodyBiped.cs:45</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone_html_a38ba95a86cc87ed9d13d0ff7f033afbc"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#a38ba95a86cc87ed9d13d0ff7f033afbc">RootMotion.FinalIK.FBBIKHeadEffector.BendBone.transform</a></div><div class="ttdeci">Transform transform</div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00044">FBBIKHeadEffector.cs:44</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_effector_html_a52f2871aaf5b38273bde9e1910b6626b"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_effector.html#a52f2871aaf5b38273bde9e1910b6626b">RootMotion.FinalIK.IKEffector.positionOffset</a></div><div class="ttdeci">Vector3 positionOffset</div><div class="ttdoc">The position offset in world space. positionOffset will be reset to Vector3.zero each frame after the...</div><div class="ttdef"><b>Definition:</b> <a href="_i_k_effector_8cs_source.html#l00050">IKEffector.cs:50</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped_html_ad29051cd81fc4542d0e9517ee99a4c64"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#ad29051cd81fc4542d0e9517ee99a4c64">RootMotion.FinalIK.IKSolverFullBodyBiped.rightShoulderEffector</a></div><div class="ttdeci">IKEffector rightShoulderEffector</div><div class="ttdoc">Gets the right shoulder effector. </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_biped_8cs_source.html#l00073">IKSolverFullBodyBiped.cs:73</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped_html_a8f89027d56337408f1de36867867f58e"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#a8f89027d56337408f1de36867867f58e">RootMotion.FinalIK.IKSolverFullBodyBiped.pullBodyOffset</a></div><div class="ttdeci">Vector3 pullBodyOffset</div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_biped_8cs_source.html#l00463">IKSolverFullBodyBiped.cs:463</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k_html"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html">RootMotion.FinalIK.FullBodyBipedIK</a></div><div class="ttdoc">Full Body IK System designed specifically for bipeds </div><div class="ttdef"><b>Definition:</b> <a href="_full_body_biped_i_k_8cs_source.html#l00011">FullBodyBipedIK.cs:11</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped_html_af0f747553657a86a31e46d7a77286274"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_biped.html#af0f747553657a86a31e46d7a77286274">RootMotion.FinalIK.IKSolverFullBodyBiped.bodyEffector</a></div><div class="ttdeci">IKEffector bodyEffector</div><div class="ttdoc">Gets the body effector. </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_biped_8cs_source.html#l00065">IKSolverFullBodyBiped.cs:65</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_html_a644052615e27543f862039ef09a8d2a3"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#a644052615e27543f862039ef09a8d2a3">RootMotion.FinalIK.IKSolverFullBody.OnPreIteration</a></div><div class="ttdeci">IterationDelegate OnPreIteration</div><div class="ttdoc">Called before each iteration </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_8cs_source.html#l00135">IKSolverFullBody.cs:135</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k_html_a0dfac5c2550dad76128806dd5fdc019b"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_full_body_biped_i_k.html#a0dfac5c2550dad76128806dd5fdc019b">RootMotion.FinalIK.FullBodyBipedIK.references</a></div><div class="ttdeci">BipedReferences references</div><div class="ttdoc">The biped definition. Don&amp;#39;t change refences directly in runtime, use SetReferences(BipedReferences re...</div><div class="ttdef"><b>Definition:</b> <a href="_full_body_biped_i_k_8cs_source.html#l00052">FullBodyBipedIK.cs:52</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_html"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector.html">RootMotion.FinalIK.FBBIKHeadEffector</a></div><div class="ttdoc">Head effector for FBBIK. </div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00009">FBBIKHeadEffector.cs:9</a></div></div>
<div class="ttc" id="class_root_motion_1_1_v3_tools_html"><div class="ttname"><a href="class_root_motion_1_1_v3_tools.html">RootMotion.V3Tools</a></div><div class="ttdoc">Helper methods for dealing with 3-dimensional vectors. </div><div class="ttdef"><b>Definition:</b> <a href="_v3_tools_8cs_source.html#l00009">V3Tools.cs:9</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_html"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html">RootMotion.FinalIK.IKSolver</a></div><div class="ttdoc">The base abstract class for all IK solvers </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_8cs_source.html#l00010">IKSolver.cs:10</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_html_aea393686f485cd8fed883cb6f757a1e7"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#aea393686f485cd8fed883cb6f757a1e7">RootMotion.FinalIK.IKSolverFullBody.OnFixTransforms</a></div><div class="ttdeci">UpdateDelegate OnFixTransforms</div><div class="ttdoc">Called when the bones used by the solver will reset to the default local state. </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_8cs_source.html#l00155">IKSolverFullBody.cs:155</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_html_a848d38a01f7498761a3f9964a66f0555"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver.html#a848d38a01f7498761a3f9964a66f0555">RootMotion.FinalIK.IKSolver.OnPostUpdate</a></div><div class="ttdeci">UpdateDelegate OnPostUpdate</div><div class="ttdoc">Called after writing the solved pose </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_8cs_source.html#l00395">IKSolver.cs:395</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone_html_ad36fe7fb4551cb96e04b456a5b174fb5"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_f_b_b_i_k_head_effector_1_1_bend_bone.html#ad36fe7fb4551cb96e04b456a5b174fb5">RootMotion.FinalIK.FBBIKHeadEffector.BendBone.FixTransforms</a></div><div class="ttdeci">void FixTransforms()</div><div class="ttdef"><b>Definition:</b> <a href="_f_b_b_i_k_head_effector_8cs_source.html#l00062">FBBIKHeadEffector.cs:62</a></div></div>
<div class="ttc" id="class_root_motion_1_1_biped_references_html_a255db332585a13c4e6d08602a74fb4ac"><div class="ttname"><a href="class_root_motion_1_1_biped_references.html#a255db332585a13c4e6d08602a74fb4ac">RootMotion.BipedReferences.rightUpperArm</a></div><div class="ttdeci">Transform rightUpperArm</div><div class="ttdoc">The first bone of the right arm. </div><div class="ttdef"><b>Definition:</b> <a href="_biped_references_8cs_source.html#l00062">BipedReferences.cs:62</a></div></div>
<div class="ttc" id="namespace_unity_engine_html"><div class="ttname"><a href="namespace_unity_engine.html">UnityEngine</a></div></div>
<div class="ttc" id="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body_html_a1c5503fc656cad2bdb10bfc511760424"><div class="ttname"><a href="class_root_motion_1_1_final_i_k_1_1_i_k_solver_full_body.html#a1c5503fc656cad2bdb10bfc511760424">RootMotion.FinalIK.IKSolverFullBody.iterations</a></div><div class="ttdeci">int iterations</div><div class="ttdoc">Number of solver iterations. </div><div class="ttdef"><b>Definition:</b> <a href="_i_k_solver_full_body_8cs_source.html#l00018">IKSolverFullBody.cs:18</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_84bbf7b3c7f28a5a18725745e1505219.html">Assets</a></li><li class="navelem"><a class="el" href="dir_c0005b12c1c6ae1cb8e9754bcab8bc3c.html">Plugins</a></li><li class="navelem"><a class="el" href="dir_c0726432ada3de9e3d2a12572beaebec.html">RootMotion</a></li><li class="navelem"><a class="el" href="dir_92548afe4ff1affb2d70b4be084923d6.html">FinalIK</a></li><li class="navelem"><a class="el" href="dir_3ffdd09c0880c9e597ef89acee439676.html">IK Solvers</a></li><li class="navelem"><a class="el" href="_f_b_b_i_k_head_effector_8cs.html">FBBIKHeadEffector.cs</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
